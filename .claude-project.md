# AllegroGraph MCP Server Project

## Project Information

This is the AllegroGraph Model Context Protocol (MCP) server that provides tools for interacting with AllegroGraph RDF databases.

## Development Directories

### Linux/WSL Directory
- **Path**: `/home/test/agraph-mcp`
- **Purpose**: Primary development environment

### Windows Directory
- **Path**: `/mnt/c/Users/jansa/agraph-mcp`
- **Windows Path**: `C:\Users\jansa\agraph-mcp`
- **Purpose**: Claude Desktop MCP server deployment
- **Config Location**: Claude Desktop config points to `C:\Users\jansa\agraph-mcp\dist\index.js`

## Important Notes

### Development Workflow
When making changes to the codebase:
1. Edit files in the Linux directory (`/home/test/agraph-mcp`)
2. After building/testing, copy changes to Windows directory (`/mnt/c/Users/jansa/agraph-mcp`)
3. Rebuild in Windows directory: `cd /mnt/c/Users/jansa/agraph-mcp && npm run build`
4. Restart Claude Desktop to pick up changes

### ⚠️ CRITICAL: MCP Resources vs Tools

**MCP Resources DO NOT work reliably in Claude Desktop!**

- **Resources** (like `allegro://docs/query-workflow`) are listed but Claude Desktop does not consistently read them
- **Tools** (like `read_query_workflow`) are reliably called when their descriptions say "CRITICAL: Read this FIRST"

**Best Practice:** For any critical documentation that Claude Desktop needs to read:
- Create a **tool** (not just a resource)
- Use directive language in description: "CRITICAL: Read this FIRST before..."
- Return the documentation content when the tool is called

**Examples:**
- ✅ `read_query_workflow` - Tool that returns workflow (works)
- ✅ `read_fti_tutorial` - Tool that returns FTI docs (works)
- ✅ `read_vector_tutorial` - Tool that returns vector docs (works)
- ✅ `read_visualization_guidelines` - Tool that returns viz docs (works)
- ❌ `allegro://docs/query-workflow` - Resource (unreliable)

**Testing Observation:** First query in a session is slower because Claude Desktop reads the workflow/tutorials. Follow-up queries are faster because the content is in context.

## Claude Desktop Configuration

The Windows setup uses this config (from Claude Desktop):
```json
{
  "mcpServers": {
    "allegro-graph": {
      "command": "node",
      "args": ["C:\\Users\\jansa\\agraph-mcp\\dist\\index.js"],
      "env": {
        "ALLEGRO_HOST": "flux.franz.com",
        "ALLEGRO_PORT": "10000",
        "ALLEGRO_USERNAME": "demos",
        "ALLEGRO_PASSWORD": "demos",
        "ALLEGRO_CATALOG": "demos",
        "ALLEGRO_REPOSITORY": "olympics",
        "ALLEGRO_PROTOCOL": "https"
      }
    }
  }
}
```

## Repository Structure

- `src/index.ts` - Main MCP server implementation
- `freetext-index-tutorial.txt` - Freetext indexing documentation
- `nearest-neighbor-and-askMyDocuments.txt` - Vector store and RAG documentation
- `dist/` - Compiled JavaScript output
- `node_modules/` - Dependencies

## MCP Server Features

### Tools (26 total)
1. **SPARQL Query Tools** (4): sparql_query, sparql_update, federated_query, generate_sparql_only
2. **Repository Management** (4): list_repositories, set_repository, get_current_repository, get_repository_info
3. **Data Management** (1): add_triples
4. **Schema Discovery** (1): get_shacl
5. **Query Library** (5): search_queries, list_all_queries, store_query, store_query_visualization, get_query_visualizations
6. **Freetext Indexing** (3): list_fti_indices, get_fti_index_config, read_fti_tutorial
7. **Vector Store & RAG** (4): vector_nearest_neighbor, vector_ask_documents, check_vector_store, read_vector_tutorial
8. **Visualization** (1): read_visualization_guidelines
9. **Workflow & Best Practices** (1): read_query_workflow

### Resources
- `allegro://docs/query-workflow` - SPARQL query workflow best practices
- `allegro://docs/freetext-indexing` - Freetext indexing tutorial
- `allegro://docs/vector-store` - Vector store and RAG tutorial
- `allegro://docs/visualization-guidelines` - Chart.js visualization best practices (CRITICAL: use Chart.js, not React)
- `allegro://<repo>/shacl` - SHACL schema for each repository
- `allegro://<repo>/info` - Repository information
- `allegro://<repo>/namespaces` - Namespace prefixes
